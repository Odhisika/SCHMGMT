{% extends 'base.html' %}
{% load i18n static %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/clean-ui.css' %}">
<style>
    .bank-field, .momo-field {
        transition: opacity 0.3s;
    }
</style>
{% endblock %}

{% block title %}{{ title }}{% endblock %}

{% block content %}
<nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">{% trans 'Home' %}</a></li>
        <li class="breadcrumb-item"><a href="{% url 'fees:dashboard' %}">{% trans 'Payments' %}</a></li>
        <li class="breadcrumb-item"><a href="{% url 'fees:bank_account_list' %}">{% trans 'Bank Accounts' %}</a></li>
        <li class="breadcrumb-item active">{{ title }}</li>
    </ol>
</nav>

<div class="title-1"><i class="fas fa-university"></i> {{ title }}</div>
<br>

{% include 'snippets/messages.html' %}

<div class="card-clean">
    <div class="card-body-clean">
        <form method="post" class="form-clean">
            {% csrf_token %}
            
            <div class="form-group">
                <label>{% trans 'Account Type' %}</label>
                {{ form.account_type }}
            </div>
            
            <div class="form-group">
                <label>{% trans 'Account Holder Name' %} *</label>
                {{ form.account_name }}
            </div>
            
            <!-- Bank Fields -->
            <div id="bank-fields">
                <h5 class="mt-3">{% trans 'Bank Account Details' %}</h5>
                <div class="row">
                    <div class="col-md-6 form-group">
                        <label>{% trans 'Bank Name' %}</label>
                        {{ form.bank_name }}
                    </div>
                    <div class="col-md-6 form-group">
                        <label>{% trans 'Account Number' %}</label>
                        {{ form.account_number }}
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-6 form-group">
                        <label>{% trans 'Branch' %}</label>
                        {{ form.branch }}
                    </div>
                    <div class="col-md-6 form-group">
                        <label>{% trans 'SWIFT Code' %}</label>
                        {{ form.swift_code }}
                    </div>
                </div>
            </div>
            
            <!-- Mobile Money Fields -->
            <div id="momo-fields" style="display: none;">
                <h5 class="mt-3">{% trans 'Mobile Money Details' %}</h5>
                <div class="row">
                    <div class="col-md-6 form-group">
                        <label>{% trans 'Mobile Money Number' %}</label>
                        {{ form.mobile_money_number }}
                    </div>
                    <div class="col-md-6 form-group">
                        <label>{% trans 'Network' %}</label>
                        {{ form.mobile_money_network }}
                    </div>
                </div>
            </div>
            
            <div class="row mt-3">
                <div class="col-md-6 form-group">
                    <div class="form-check">
                        {{ form.is_active }}
                        <label class="form-check-label">{% trans 'Active' %}</label>
                    </div>
                </div>
                <div class="col-md-6 form-group">
                    <div class="form-check">
                        {{ form.is_default }}
                        <label class="form-check-label">{% trans 'Set as Default' %}</label>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label>{% trans 'Instructions for Students' %}</label>
                {{ form.notes }}
            </div>
            
            <div style="margin-top: 24px; display: flex; gap: 12px;">
                <button type="submit" class="btn-success-clean">
                    <i class="fas fa-save"></i> {% trans 'Save Account' %}
                </button>
                <a href="{% url 'fees:bank_account_list' %}" class="btn-outline-clean" style="text-decoration: none;">
                    {% trans 'Cancel' %}
                </a>
            </div>
        </form>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const accountTypeSelect = document.getElementById('account-type-select');
    const bankFields = document.getElementById('bank-fields');
    const momoFields = document.getElementById('momo-fields');
    
    function toggleFields() {
        const accountType = accountTypeSelect.value;
        
        if (accountType === 'BANK') {
            bankFields.style.display = 'block';
            momoFields.style.display = 'none';
        } else {
            bankFields.style.display = 'none';
            momoFields.style.display = 'block';
        }
    }
    
    accountTypeSelect.addEventListener('change', toggleFields);
    toggleFields(); // Initialize on page load
});
</script>
{% endblock %}
