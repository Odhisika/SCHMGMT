{% extends 'base.html' %}
{% load i18n %}
{% block title %}{{ title }} | {% trans 'Learning management system' %}{% endblock title %}

{% block content %}

<nav style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="/">{% trans 'Home' %}</a></li>
        <li class="breadcrumb-item active" aria-current="page">{% trans 'Report Cards' %}</li>
    </ol>
</nav>

<div class="title-1"><i class="fas fa-file-invoice"></i> {% trans 'Report Cards Management' %}</div>
<br>

{% include 'snippets/messages.html' %}

<div class="card p-3 shadow-sm border-0 bg-light mb-4">
    <div class="row align-items-center">
        <div class="col-md-8">
            <h5 class="mb-0">{% trans 'Current Term' %}: <strong>{{ current_term|default:"Not Set" }}</strong></h5>
            <p class="text-muted mb-0 small">{% trans 'View and download student terminal report cards.' %}</p>
        </div>
    </div>
</div>

<div class="table-responsive table-shadow p-0 mt-4">
    <table class="table table-light table-striped">
        <thead>
            <tr>
                <th>#</th>
                <th>{% trans 'ID No.' %}</th>
                <th>{% trans 'Full Name' %}</th>
                <th>{% trans 'Level/Class' %}</th>
                <th>{% trans 'Program' %}</th>
                <th class="text-center">{% trans 'Actions' %}</th>
            </tr>
        </thead>
        <tbody>
            {% for student in students %}
            <tr>
                <td>{{ forloop.counter }}</td>
                <td>{{ student.student.username }}</td>
                <td>{{ student.student.get_full_name }}</td>
                <td>{{ student.level }}</td>
                <td>{{ student.program }}</td>
                <td class="text-center">
                    {% if student.result_count > 0 %}
                    <a href="{% url 'report_card_pdf' pk=student.pk %}" class="btn btn-sm btn-outline-primary" target="_blank">
                        <i class="fas fa-file-pdf"></i> {% trans 'Download PDF' %}
                    </a>
                    {% else %}
                    <span class="badge bg-warning text-dark">
                        <i class="fas fa-exclamation-triangle"></i> {% trans 'No results' %}
                    </span>
                    {% endif %}
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="6" class="text-center text-danger">{% trans 'No students found.' %}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% endblock content %}
